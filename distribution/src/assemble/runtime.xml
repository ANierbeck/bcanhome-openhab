<assembly xmlns="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://maven.apache.org/plugins/maven-assembly-plugin/assembly/1.1.0 http://maven.apache.org/xsd/assembly-1.1.0.xsd">
  <id>runtime</id>
  <formats>
    <format>zip</format>
  </formats>
  <includeBaseDirectory>false</includeBaseDirectory>
  <fileSets>
    <fileSet>
      <outputDirectory>/</outputDirectory>
      <directory>openhabhome</directory>
		<excludes>
			<exclude>*.sh</exclude>
		</excludes>
    </fileSet>
  </fileSets>
  <files>
    <file>
      <outputDirectory>/</outputDirectory>
      <source>openhabhome/start.sh</source>
      <fileMode>755</fileMode>
    </file>
  </files>

  <dependencySets>
    <dependencySet>
    	<useStrictFiltering>true</useStrictFiltering>
    	<useProjectArtifact>false</useProjectArtifact>
			<useTransitiveDependencies>false</useTransitiveDependencies>
      <outputDirectory>server</outputDirectory>
      <unpack>true</unpack>
      <unpackOptions>
		<!-- we need to manually exclude bundles that tycho adds to the product build
		     (possibly because it includes optional dependencies). As these things are
		     not needed for the runtime, we can decrease the zip size enormously.
		-->
		<excludes>
			<exclude>**/org.eclipse.ui*.jar</exclude>
			<exclude>**/org.eclipse.jface*.jar</exclude>
			<exclude>**/org.eclipse.*.ui*.jar</exclude>
			<exclude>**/org.eclipse.team*.jar</exclude>
			<exclude>**/org.eclipse.debug*.jar</exclude>
			<exclude>**/org.eclipse.compare*.jar</exclude>
			<exclude>**/org.eclipse.search*.jar</exclude>
			<exclude>**/org.eclipse.help*.jar</exclude>
			<exclude>**/org.eclipse.equinox.launcher.win32*</exclude>
			<exclude>**/org.eclipse.equinox.launcher.win32*</exclude>
		</excludes>
      </unpackOptions>      
      <includes>
      	<include>*:org.openhab.runtime.product:zip:*</include>
      </includes>
    </dependencySet>
  </dependencySets>
</assembly>
